<!DOCTYPE html>
<html lang="en-us">
<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>King Fox And Butterfly</title>
<meta name="description" content="A blog about cooking and statistics.">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="http://liyingbo.com/css/bootstrap.min.css">
<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Roboto:400,300,700,400italic">
<link rel="stylesheet" href="http://liyingbo.com/css/font-awesome.min.css">
<link rel="stylesheet" href="http://liyingbo.com/css/owl.carousel.css">
<link rel="stylesheet" href="http://liyingbo.com/css/owl.theme.css">


  <link href="http://liyingbo.com/css/style.blue.css" rel="stylesheet" id="theme-stylesheet">

 

  
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  


<link href="http://liyingbo.com/css/custom.css" rel="stylesheet">
<link rel="shortcut icon" href="http://liyingbo.com/img/favicon.png">


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-116913878-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</head>
<body>
  <div id="all">
      <div class="container-fluid">
          <div class="row row-offcanvas row-offcanvas-left">
              <div id="sidebar" class="col-xs-6 col-sm-4 col-md-3 sidebar-offcanvas">
  <div class="sidebar-content">
    <h1 class="sidebar-heading"><a href="http://liyingbo.com">King Fox And Butterfly</a></h1>
    
      <p class="sidebar-p">I am a home cook and statistian, both with more than 10 years of experience.</p>
    
      <p class="sidebar-p">Originally from Shanghai, currently based in Dallas.</p>
    
    <ul class="sidebar-menu">
      
        <li><a href="http://liyingbo.com/cooking/">Cooking</a></li>
      
        <li><a href="http://liyingbo.com/stat/">Statistics</a></li>
      
        <li><a href="http://liyingbo.com/about/">About Me</a></li>
      
        <li><a href="http://liyingbo.com/categories/">Categories</a></li>
      
        <li><a href="http://liyingbo.com/tags/">Tags</a></li>
      
    </ul>
    <p class="social">
  
  
  
  
  
  
  <a href="https://www.linkedin.com/in/yingbo-li-08321723/" data-animate-hover="pulse" class="external">
    <i class="fa fa-linkedin"></i>
  </a>
  
  
  
  <a href="https://github.com/yingboli" data-animate-hover="pulse" class="external">
    <i class="fa fa-github"></i>
  </a>
  
  
  
  
</p>


    <div class="copyright">
      <p class="credit">
        
          &copy; Yingbo Li 2018 -- 2021 |
        
        Template by <a href="https://bootstrapious.com/free-templates" class="external">Bootstrapious.com</a>

&amp; ported to Hugo by <a href="https://github.com/kishaningithub">Kishan B</a>

      </p>
    </div>
  </div>
</div>

              
<div class="col-xs-12 col-sm-8 col-md-9 content-column white-background">
  <div class="small-navbar visible-xs">
  <button type="button" data-toggle="offcanvas" class="btn btn-ghost pull-left"> <i class="fa fa-align-left"> </i>Menu</button>
  <h1 class="small-navbar-heading"><a href="http://liyingbo.com">King Fox And Butterfly</a></h1>
</div>

  <div class="row">
    <div class="col-lg-8">
      <div class="content-column-content">
         <h1>Book Notes: Computer Age Statistical Inference -- Ch9 Survival Analysis</h1>
         

<div id="TOC">
<ul>
<li><a href="#survival-analysis">Survival Analysis</a><ul>
<li><a href="#life-table-and-kaplan-meier-estimate">Life Table and Kaplan-Meier Estimate</a></li>
<li><a href="#coxs-proportional-hazards-model">Cox’s Proportional Hazards Model</a></li>
</ul></li>
</ul>
</div>

<p><strong><em>For the pdf slides, click <a href="/pdf/052219_computer_age_stat_inference_Part2_Ch9.pdf">here</a></em></strong></p>
<div id="survival-analysis" class="section level1">
<h1>Survival Analysis</h1>
<div id="life-table-and-kaplan-meier-estimate" class="section level2">
<h2>Life Table and Kaplan-Meier Estimate</h2>
<div id="life-table" class="section level3">
<h3>Life table</h3>
<ul>
<li><p>An insurance company’s <font color='blue'>life table</font> shows information of clients by
their age. For each age <span class="math inline">\(i\)</span>, it contains</p>
<ul>
<li><span class="math inline">\(n_i\)</span>: number of clients</li>
<li><span class="math inline">\(y_i\)</span>: number of death</li>
<li><span class="math inline">\(\hat{h}_i = y_i / n_i\)</span>: hazard rate</li>
<li><span class="math inline">\(\hat{S}_i\)</span>: survival probability estimate</li>
</ul></li>
<li><p>An example life table</p></li>
</ul>
<table>
<thead>
<tr class="header">
<th>Age</th>
<th><span class="math inline">\(n\)</span></th>
<th><span class="math inline">\(y\)</span></th>
<th><span class="math inline">\(\hat{h}\)</span></th>
<th><span class="math inline">\(\hat{S}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>34</td>
<td>120</td>
<td>0</td>
<td>0.000</td>
<td>1.000</td>
</tr>
<tr class="even">
<td>35</td>
<td>71</td>
<td>1</td>
<td>0.014</td>
<td>0.986</td>
</tr>
<tr class="odd">
<td>36</td>
<td>125</td>
<td>0</td>
<td>0.000</td>
<td>0.986</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
</tbody>
</table>
</div>
<div id="discrete-survival-analysis-notations" class="section level3">
<h3>Discrete survival analysis: notations</h3>
<ul>
<li>A client’s lifetime (<font color='blue'>time until event</font>): random variable <span class="math inline">\(X\)</span>
<ul>
<li>Also called <font color='blue'>failure time</font>, <font color='blue'>survival time</font>, or
<font color='blue'>event time</font></li>
</ul></li>
<li><p>Probability of dying at age <span class="math inline">\(i\)</span>
<span class="math display">\[
f_i = P(X = i)
\]</span></p></li>
<li><p>Probability of surviving past age <span class="math inline">\(i\)</span>
<span class="math display">\[
S_i = \sum_{j \geq i + 1} f_j = P(X &gt; i)
\]</span></p></li>
<li><p><font color='blue'>Hazard rate</font> at age <span class="math inline">\(i\)</span>: conditional probability
<span class="math display">\[
h_i = \frac{f_i}{S_{i-1}} = P(X = i \mid X \geq i)
\]</span></p></li>
</ul>
</div>
<div id="life-table-estimations" class="section level3">
<h3>Life table estimations</h3>
<ul>
<li>Hazard rate estimation: binomial proportions
<span class="math display">\[
\hat{h}_i = \frac{y_i}{n_i}
\]</span>
<ul>
<li>Typical frequentist inference: probabilistic results <span class="math inline">\(h_i\)</span> is
estimated by the plug-in principle</li>
</ul></li>
<li><p>Probability of surviving past age <span class="math inline">\(j\)</span> given survival past age <span class="math inline">\(i\)</span>:
<span class="math display">\[
P(X &gt; j \mid X &gt; i) = \prod_{k = i+1}^j P(X &gt; k \mid X \geq k) 
= \prod_{k = i+1}^j (1 - h_k)
\]</span></p></li>
<li><p>Probability of survival estimation
<span class="math display">\[
\hat{S}_j = \prod_{k={i_0}}^j \left( 1 - \hat{h}_k\right)
\]</span>
where <span class="math inline">\(i_0\)</span> is the starting age</p></li>
</ul>
</div>
<div id="continuous-survival-analysis-notations" class="section level3">
<h3>Continuous survival analysis: notations</h3>
<ul>
<li><p><font color='blue'>Time until event</font> <span class="math inline">\(T\)</span>: a continuous positive random variable,
with pdf <span class="math inline">\(f(t)\)</span> and cdf <span class="math inline">\(F(t)\)</span></p></li>
<li><p><font color='blue'>Survival function</font> (i.e., reverse cdf)
<span class="math display">\[
S(t) = \int_{t}^{\infty} f(x) dx = P(T &gt; t) = 1- F(t)
\]</span></p></li>
<li><font color='blue'>Hazard rate</font>, also called <font color='blue'>hazard function</font>
<span class="math display">\[
h(t) = \frac{f(t)}{S(t)} = 
\lim_{\Delta t \rightarrow 0} \frac{P(t &lt; T \leq t + \Delta t \mid T &gt; t)}{\Delta t}
\]</span>
<ul>
<li>In some other books, hazard rate is denoted as <span class="math inline">\(\lambda(t)\)</span></li>
</ul></li>
</ul>
</div>
<div id="hazard-rate-and-cumulative-hazard-function" class="section level3">
<h3>Hazard rate and cumulative hazard function</h3>
<ul>
<li><p>Connection between hazard rate <span class="math inline">\(h(t)\)</span> and survival function <span class="math inline">\(S(t)\)</span>
<span class="math display">\[
h(t) = -\frac{\partial \log S(t)}{\partial t} \quad
\Longleftrightarrow \quad
S(t) = \exp\left\{ -\int_0^t h(x)dx \right\}
\]</span></p></li>
<li><p><font color='blue'>Cumulative hazard function</font>
<span class="math display">\[
\Lambda(t) = \int_0^t h(x) dx = -\log S(t)
\]</span></p></li>
<li><p><font color='red'>Knowing any of</font> <span class="math inline">\(S(t)\)</span>, <span class="math inline">\(h(t)\)</span>, <span class="math inline">\(\Lambda(t)\)</span> <font color='red'>allows one to derive the other two</font></p></li>
<li><font color='green'>Example: exponential distributed <span class="math inline">\(T\)</span></font>
<span class="math display">\[
f(t) = \lambda e^{- \lambda t} \quad \Longrightarrow \quad
S(t) = e^{-\lambda t}, \quad h(t) = \lambda
\]</span>
<ul>
<li>Constant hazard rate: menoryless</li>
</ul></li>
</ul>
</div>
<div id="censored-data" class="section level3">
<h3>Censored data</h3>
<ul>
<li><font color='blue'>Censored data</font>: survival times known only to exceed the reported value
<ul>
<li>E.g., lost to followup, experiment ended with some patients still alive</li>
<li>Usually denoted as “number+”</li>
</ul></li>
<li>Observation <span class="math inline">\(z_i\)</span> for censored data:
<span class="math display">\[
z = (t_i, d_i), 
\]</span>
where <span class="math inline">\(t_i\)</span> is the survival time, and <span class="math inline">\(d_i\)</span> is the indicator
<span class="math display">\[
d_i = \begin{cases}
    1 &amp; \text{if death observed}\\
    0 &amp; \text{if death not observed}
    \end{cases}
\]</span></li>
</ul>
</div>
<div id="kaplan-meier-estimate" class="section level3">
<h3>Kaplan-Meier estimate</h3>
<ul>
<li><p>Among the censored data <span class="math inline">\(z_1, \ldots, z_n\)</span>, we denote the
<font color='blue'>ordered survival times</font> as
<span class="math display">\[
t_{(1)} &lt; t_{(2)} &lt; \ldots &lt; t_{(n)},
\]</span>
assuming no ties.</p></li>
<li><p>The <font color='blue'>Kaplan-Meier estimate</font> for survival probability
<span class="math inline">\(S_{(j)} = P(X &gt; t_{(j)})\)</span> is the life table estimate
<span class="math display">\[
\hat{S}_{(j)} = \prod_{k \leq j} \left( \frac{n-k}{n-k+1} \right)^{d_{(k)}}
\]</span></p></li>
<li><p>Life table curves are nonparametric: no relationship is assumed between
the hazard rates <span class="math inline">\(h_i\)</span></p></li>
</ul>
</div>
<div id="a-parametric-approach" class="section level3">
<h3>A parametric approach</h3>
<ul>
<li><p>Death counts <span class="math inline">\(y_k\)</span> are independent Binomials
<span class="math display">\[
y_k \stackrel{ind}{\sim} \text{B}(n_k, h_k)
\]</span></p></li>
<li><p>Logistic regression
<span class="math display">\[
log\left( \frac{h_k}{1-h_k} \right) = \boldsymbol\alpha \mathbf{x}_k
\]</span></p>
<ul>
<li><p>E.g., cubic regression:
<span class="math display">\[
  x_k = (1, k, k^2, k^3)&#39;
  \]</span></p></li>
<li><p>E.g., cubic-linear spline:
<span class="math display">\[
  x_k = (1, k, (k - k_0)_-^2, (k - k_0)_-^3)&#39;
  \]</span>
where <span class="math inline">\(x_- = x \cdot \mathbf{1}_{x \leq 0}\)</span></p></li>
</ul></li>
</ul>
</div>
</div>
<div id="coxs-proportional-hazards-model" class="section level2">
<h2>Cox’s Proportional Hazards Model</h2>
<div id="coxs-proportional-hazards-model-1" class="section level3">
<h3>Cox’s proportional hazards model</h3>
<ul>
<li><p><font color='blue'>Proportional hazards model</font> assumes
<span class="math display">\[
h_i(t) = h_0(t) \cdot e^{\mathbf{x}_i&#39; \boldsymbol\beta},
\]</span>
where <span class="math inline">\(h_0(t)\)</span> is a baseline hazard, which we don’t need to specify</p></li>
<li><p>Denote <span class="math inline">\(\theta_i = e^{\mathbf{x}_i&#39; \boldsymbol\beta}\)</span>, then
<span class="math display">\[
S_i(t) = S_0(t)^{\theta_i},
\]</span>
where <span class="math inline">\(S_0(t)\)</span> is the baseline survival function</p>
<ul>
<li>Larger value of <span class="math inline">\(\theta_i\)</span> indicates more quickly declining (i.e., worse)
survival curves</li>
<li>Positive value of the coefficient <span class="math inline">\(\beta_j\)</span> indicates increase of
the corresponding covariate <span class="math inline">\(x_j\)</span> associating with worse survival curves</li>
</ul></li>
</ul>
</div>
<div id="proportional-hazards-model-key-results" class="section level3">
<h3>Proportional hazards model: key results</h3>
<ul>
<li><p>Let <span class="math inline">\(J\)</span> be the number of observed deaths, occurring at times
<span class="math display">\[
T_{(1)} &lt; T_{(2)} &lt; \ldots &lt; T_{(J)}
\]</span>
assuming no ties</p></li>
<li><p>Just before time <span class="math inline">\(T_{(j)}\)</span> there is a <font color='blue'>risk set</font> of
individuals still under observation
<span class="math display">\[
R_j = \{i, t_i \geq T_{(j)}\}
\]</span></p></li>
<li><p><font color='red'>Key results of the proportional hazards model</font>: given one person
dies at time <span class="math inline">\(T_{(j)}\)</span>, the probablity it is person <span class="math inline">\(i\)</span>, among the set of
people at risk, is
<span class="math display">\[
P(i_j = i \mid R_j) = \frac{e^{\mathbf{x}_i&#39; \boldsymbol\beta}}
{\sum_{k \in R_j} e^{\mathbf{x}_j&#39; \boldsymbol\beta}} = 
\frac{\theta_i}{\sum_{k \in R_j} \theta_j}
\]</span></p></li>
</ul>
</div>
<div id="parameter-estimation-based-on-the-partial-likelihood" class="section level3">
<h3>Parameter estimation: based on the partial likelihood</h3>
<ul>
<li><p>Estimaiton of <span class="math inline">\(\boldsymbol\beta\)</span> is to maximize the
<font color='blue'>partial likelihood</font>
<span class="math display">\[
L(\boldsymbol\beta) = \prod_{j=1}^J \frac{e^{\mathbf{x}_{i_j}&#39; \boldsymbol\beta}}
{\sum_{k \in R_j} e^{\mathbf{x}_j&#39; \boldsymbol\beta}}
\]</span>
where individual <span class="math inline">\(i_j\)</span> dies at time <span class="math inline">\(T_{(j)}\)</span></p></li>
<li><p><font color='red'>Semi-parametric</font>: we do not need to specify the baseline <span class="math inline">\(h_0(t)\)</span>,
since it is not contained in the objective function</p></li>
</ul>
</div>
<div id="references" class="section level3">
<h3>References</h3>
<ul>
<li>Efron, Bradley and Hastie, Trevor (2016), <em>Computer Age Statistical Inference</em>.
Cambridge University Press</li>
</ul>
</div>
</div>
</div>

         <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "kfab" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
      </div>
    </div>
  </div>
</div>

          </div>
      </div>
  </div>
  <script src="http://liyingbo.com/js/jquery.min.js"></script>
<script src="http://liyingbo.com/js/bootstrap.min.js"></script>
<script src="http://liyingbo.com/js/jquery.cookie.js"> </script>
<script src="http://liyingbo.com/js/ekko-lightbox.js"></script>
<script src="http://liyingbo.com/js/jquery.scrollTo.min.js"></script>
<script src="http://liyingbo.com/js/masonry.pkgd.min.js"></script>
<script src="http://liyingbo.com/js/imagesloaded.pkgd.min.js"></script>
<script src="http://liyingbo.com/js/owl.carousel.min.js"></script>
<script src="http://liyingbo.com/js/front.js"></script>




<script>
    MathJax = {
        tex: {
            macros: {
                E: ['\\mathbf{E}'],
                V: ['\\mathbf{Var}'],
                C: ['\\mathbf{Cov}'],
                AV: ['\\mathbf{AVar}']
            }
        }
    };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>

</body>
</html>
