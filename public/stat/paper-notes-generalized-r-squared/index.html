<!DOCTYPE html>
<html lang="en-us">
<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>King Fox And Butterfly</title>
<meta name="description" content="A blog about cooking and statistics.">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="http://liyingbo.com/css/bootstrap.min.css">
<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Roboto:400,300,700,400italic">
<link rel="stylesheet" href="http://liyingbo.com/css/font-awesome.min.css">
<link rel="stylesheet" href="http://liyingbo.com/css/owl.carousel.css">
<link rel="stylesheet" href="http://liyingbo.com/css/owl.theme.css">


  <link href="http://liyingbo.com/css/style.blue.css" rel="stylesheet" id="theme-stylesheet">

 

  
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  


<link href="http://liyingbo.com/css/custom.css" rel="stylesheet">
<link rel="shortcut icon" href="http://liyingbo.com/img/favicon.png">


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-116913878-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</head>
<body>
  <div id="all">
      <div class="container-fluid">
          <div class="row row-offcanvas row-offcanvas-left">
              <div id="sidebar" class="col-xs-6 col-sm-4 col-md-3 sidebar-offcanvas">
  <div class="sidebar-content">
    <h1 class="sidebar-heading"><a href="http://liyingbo.com">King Fox And Butterfly</a></h1>
    
      <p class="sidebar-p">I am a home cook and statistian, both with more than 10 years of experience.</p>
    
      <p class="sidebar-p">Originally from Shanghai, currently based in Dallas.</p>
    
    <ul class="sidebar-menu">
      
        <li><a href="http://liyingbo.com/cooking/">Cooking</a></li>
      
        <li><a href="http://liyingbo.com/stat/">Statistics</a></li>
      
        <li><a href="http://liyingbo.com/about/">About Me</a></li>
      
        <li><a href="http://liyingbo.com/categories/">Categories</a></li>
      
        <li><a href="http://liyingbo.com/tags/">Tags</a></li>
      
    </ul>
    <p class="social">
  
  
  
  
  
  
  <a href="https://www.linkedin.com/in/yingbo-li-08321723/" data-animate-hover="pulse" class="external">
    <i class="fa fa-linkedin"></i>
  </a>
  
  
  
  <a href="https://github.com/yingboli" data-animate-hover="pulse" class="external">
    <i class="fa fa-github"></i>
  </a>
  
  
  
  
</p>


    <div class="copyright">
      <p class="credit">
        
          &copy; Yingbo Li 2018 -- 2021 |
        
        Template by <a href="https://bootstrapious.com/free-templates" class="external">Bootstrapious.com</a>

&amp; ported to Hugo by <a href="https://github.com/kishaningithub">Kishan B</a>

      </p>
    </div>
  </div>
</div>

              
<div class="col-xs-12 col-sm-8 col-md-9 content-column white-background">
  <div class="small-navbar visible-xs">
  <button type="button" data-toggle="offcanvas" class="btn btn-ghost pull-left"> <i class="fa fa-align-left"> </i>Menu</button>
  <h1 class="small-navbar-heading"><a href="http://liyingbo.com">King Fox And Butterfly</a></h1>
</div>

  <div class="row">
    <div class="col-lg-8">
      <div class="content-column-content">
         <h1>Paper Notes: Generalized R Squared </h1>
         

<div id="TOC">
<ul>
<li><a href="#generalized-r2-by-cox-and-snell">Generalized <span class="math inline">\(R^2\)</span> by Cox and Snell</a></li>
<li><a href="#generalized-r2-by-nagelkerke">Generalized <span class="math inline">\(R^2\)</span> by Nagelkerke</a><ul>
<li><a href="#generalized-r2-for-binary-data">Generalized <span class="math inline">\(R^2\)</span> for binary data</a></li>
</ul></li>
</ul>
</div>

<p><strong><em><font color='red'>For the pdf slides, click <a href="/pdf/100420_generalized_R2.pdf">here</a></font></em></strong></p>
<div id="r2-for-normal-linear-regression" class="section level3">
<h3><span class="math inline">\(R^2\)</span> for normal linear regression</h3>
<ul>
<li><p><span class="math inline">\(R^2\)</span>, also called <font color='blue'>coefficient of determination</font> or <font color='blue'>multiple correlation coefficient</font>,
is defined for normal linear regression,
as the proportion of variance “explained” by the regression model
<span class="math display">\[\begin{equation}\label{eq:R2}
R^2 = \frac{\sum_i \left( y_i - \hat{y}_i \right)^2}{\sum_i \left( y_i - \bar{y} \right)^2}
\end{equation}\]</span></p></li>
<li><p>Note that under the MLE, where <span class="math inline">\(\hat{\sigma}^2 = \sum_i \left( y_i - \hat{y}_i \right)^2 / n\)</span>,
the deviance (i.e., negative two times log likelihood) is
<span class="math display">\[\begin{align*}
-2 l\left(\hat{\beta}\right) &amp; = -2 \log L(\hat{\beta})\\
&amp; = n \log(2\pi\hat{\sigma}^2) + \frac{\sum_i \left( y_i - \hat{y}_i \right)^2}{\hat{\sigma}^2}\\
&amp; = n \left[ \log\left( \frac{\sum_i \left( y_i - \hat{y}_i \right)^2}{n} \right) + \log(2\pi) + 1 \right]
\end{align*}\]</span></p>
<ul>
<li>I list this derivation here to make clear that the following generalized <span class="math inline">\(R^2\)</span> contains  as a special case for normal linear regression</li>
</ul></li>
</ul>
</div>
<div id="generalized-r2-by-cox-and-snell" class="section level1">
<h1>Generalized <span class="math inline">\(R^2\)</span> by Cox and Snell</h1>
<div id="generalized-r2-proposed-by-cox-and-snell-1989-and-also-magee-1990-and-maddala-1983" class="section level3">
<h3>Generalized <span class="math inline">\(R^2\)</span>, proposed by Cox and Snell [1989] (and also Magee [1990] and Maddala [1983])</h3>
<ul>
<li><p>The <font color='blue'>genralized <span class="math inline">\(R^2\)</span></font> for more general models where</p>
<ol style="list-style-type: decimal">
<li>the concept of residual variance cannot be easily define, and</li>
<li>maximum likelihood is the criterion of fit, is
<span class="math display">\[\begin{equation} \label{eq:generalized_R2_v1}
R^2 = 1 - \exp\left\{ -\frac{2}{n}\left[l\left(\hat{\beta}\right) - l(\hat{0})  \right] \right\} 
= 1 - \left[L(0)/L\left(\hat{\beta}\right)\right]^{2/n}
\end{equation}\]</span></li>
</ol></li>
<li><p>Here, <span class="math inline">\(L\left(\hat{\beta}\right)\)</span> and <span class="math inline">\(L(0)\)</span> are the likelihood of the fitted and the null models, respectively.</p></li>
<li><p>For normal linear regression, this generalized <span class="math inline">\(R^2\)</span>  becomes the classical <span class="math inline">\(R^2\)</span> </p></li>
</ul>
</div>
<div id="desirable-properties-of-the-generalized-r2-as-in-eq" class="section level3">
<h3>Desirable properties of the generalized <span class="math inline">\(R^2\)</span>, as in Eq </h3>
<ol style="list-style-type: decimal">
<li><p><font color='green'>Consistent with classical <span class="math inline">\(R^2\)</span></font></p></li>
<li><p><font color='green'>Consistent with maximum likelihood as an estimation method</font></p></li>
<li><p><font color='green'>Asymptotically independent of the sample size <span class="math inline">\(n\)</span></font></p></li>
<li><p><font color='green'><span class="math inline">\(1-R^2\)</span> has an interpretation as the propotion of unexplained “variation”</font></p>
<ul>
<li>For example, if we have three nested models, from smallest to largest, <span class="math inline">\(M_1, M_2\)</span>, and <span class="math inline">\(M_3\)</span>, then we have
<span class="math display">\[
 (1 - R^2_{3, 1}) = (1 - R^2_{3, 2})(1 - R^2_{2, 1})
 \]</span></li>
</ul></li>
</ol>
<ul>
<li>For more desirable properties (7 in total), please check out the Nagelkerke[1991] paper</li>
</ul>
</div>
</div>
<div id="generalized-r2-by-nagelkerke" class="section level1">
<h1>Generalized <span class="math inline">\(R^2\)</span> by Nagelkerke</h1>
<div id="generalized-r2-proposed-by-nagelkerke-1991" class="section level3">
<h3>Generalized <span class="math inline">\(R^2\)</span>, proposed by Nagelkerke [1991]</h3>
<ul>
<li><p><font color='red'>An undesirable property: for discrete models, the maximum <span class="math inline">\(R^2\)</span> is always less than 1</font>
<span class="math display">\[
\max(R^2) = 1 - L(0)^{2/n} 
\]</span></p>
<ul>
<li>This is because the likelihood of discrete target variables are from pmf (rather than from pdf, as of continuous targets)</li>
</ul></li>
<li><p><font color='blue'>A new definition of the generalized <span class="math inline">\(R^2\)</span></font>
<span class="math display">\[\begin{equation}\label{eq:generalized_R2_v2}
\bar{R}^2 = \frac{R^2}{\max(R^2)} 
= \frac{1 - \left[L(0)/L\left(\hat{\beta}\right)\right]^{2/n}}{1 - L(0)^{2/n}}
\end{equation}\]</span></p>
<ul>
<li><p>Majority of the desirable properties of , including the ones listed on the previous page, are still satisfied</p></li>
<li><p>Nagelkerke’s general <span class="math inline">\(R^2\)</span>  seems to be a popular version. For example, the biostat textbook by Steyerberg uses this version</p></li>
</ul></li>
</ul>
</div>
<div id="generalized-r2-for-binary-data" class="section level2">
<h2>Generalized <span class="math inline">\(R^2\)</span> for binary data</h2>
<div id="generalized-r2-for-binary-data-1" class="section level3">
<h3>Generalized <span class="math inline">\(R^2\)</span> for binary data</h3>
<ul>
<li><p>Denote the estimated binary probabilities as <span class="math inline">\(\hat{p}_i\)</span> for the fitted model, and <span class="math inline">\(\bar{p}\)</span> for the null model</p></li>
<li><p>Cox and Snell <span class="math inline">\(R^2\)</span>
<span class="math display">\[
R^2 
= 1 - \left[L(0)/L\left(\hat{\beta}\right)\right]^{2/n}
= 1 - \left[ \prod_i \left(\frac{\bar{p}}{\hat{p}_i}  \right)^{y_i} 
\left(\frac{1-\bar{p}}{1-\hat{p}_i}  \right)^{1-y_i}\right]^{2/n}
\]</span></p></li>
<li><p>Nagelkerke <span class="math inline">\(R^2\)</span>
<span class="math display">\[
\bar{R}^2 
= \frac{1 - \left[L(0)/L\left(\hat{\beta}\right)\right]^{2/n}}
{1 - L(0)^{2/n}}
= \frac{1 - \left[\prod_i \left(\frac{\bar{p}}{\hat{p}_i}  \right)^{y_i} 
\left(\frac{1-\bar{p}}{1-\hat{p}_i}  \right)^{1-y_i}\right]^{2/n}}
{1 - \left[\prod_i \bar{p}^{y_i} 
\left(1-\bar{p}\right)^{1-y_i}\right]^{2/n}}
\]</span></p></li>
</ul>
</div>
<div id="references" class="section level3">
<h3>References</h3>
<ul>
<li><p>Nagelkerke, N. J. D. (1991). A Note on a General Definition of the Coefficient of Determination. Biometrika, 78(3), 691-692.</p></li>
<li><p>A nice comparison of different versions of generalized <span class="math inline">\(R^2\)</span>: <a href="https://stats.idre.ucla.edu/other/mult-pkg/faq/general/faq-what-are-pseudo-r-squareds/" class="uri">https://stats.idre.ucla.edu/other/mult-pkg/faq/general/faq-what-are-pseudo-r-squareds/</a></p></li>
<li><p>Steyerberg, E. W. (2019). Clinical prediction models. Springer International Publishing.</p></li>
</ul>
</div>
</div>
</div>

         <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "kfab" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
      </div>
    </div>
  </div>
</div>

          </div>
      </div>
  </div>
  <script src="http://liyingbo.com/js/jquery.min.js"></script>
<script src="http://liyingbo.com/js/bootstrap.min.js"></script>
<script src="http://liyingbo.com/js/jquery.cookie.js"> </script>
<script src="http://liyingbo.com/js/ekko-lightbox.js"></script>
<script src="http://liyingbo.com/js/jquery.scrollTo.min.js"></script>
<script src="http://liyingbo.com/js/masonry.pkgd.min.js"></script>
<script src="http://liyingbo.com/js/imagesloaded.pkgd.min.js"></script>
<script src="http://liyingbo.com/js/owl.carousel.min.js"></script>
<script src="http://liyingbo.com/js/front.js"></script>




<script>
    MathJax = {
        tex: {
            macros: {
                E: ['\\mathbf{E}'],
                V: ['\\mathbf{Var}'],
                C: ['\\mathbf{Cov}'],
                AV: ['\\mathbf{AVar}']
            }
        }
    };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>

</body>
</html>
